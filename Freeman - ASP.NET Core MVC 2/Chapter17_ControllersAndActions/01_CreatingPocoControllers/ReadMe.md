# Создание контроллеров POCO

## Понятие контроллеров

*Контроллеры* - классы C#, открытые методы которых (*методы действий*) несут ответственность за
обработку HTTP-запроса и подготовку ответа, возвращаемого клиенту.

Любой класс `public` оканчивающийся на `Controller` является контроллером.
Любой метод `public` в таком классе является методом действия.

Чтобы класс с окончанием `Controller` не определялся как контроллер надо пометить класс
атрибутом `NonController`.

Чтобы любой класс воспринимался как контроллер, необходимо его пометить атрибутом `Controller`.

Чтобы пометить метод как не являющийся методом действия надо применить к нему атрибут `NonAction`.


## Последовательность обработки запроса

1. Система маршрутизации определяет контроллер и действие для обработки запроса.

2. Создание нового экземпляра контроллера, вызов метода действия.
Методы действия снабжаются данными контекста.

3. Применение результата метода для генерации ответа пользователю.
Самый распространенный вид ответа - визуализация представления Razor.


## Создание контроллеров POCO

`POCO` - означает `plain old CLR object`. Он не зависит от инфраструктуры ASP.NET.

Самый простой вариант (см. Controllers/SimplePocoController.cs):
```cs
public class SimplePocoController
{
    public string Index() => "This is a Simple POCO controller";
}
```

Более сложный вариант с генерацией представления Razor (см. Controllers/PocoController.cs):
```cs
public class PocoController
{
    public ViewResult Index() => new ViewResult
    {
        ViewName = "Result",
        ViewData = new ViewDataDictionary(
            new EmptyModelMetadataProvider(),
            new ModelStateDictionary())
        {
            Model = $"This is a POCO controller"
        }
    };
}
```

Здесь POCO-контроллер уже зависит от API-интерфейса MVC, т.к. запрашивает визуализацию представления
Razor.
